import{_ as w}from"./InputCode.444dd6a5.js";import{_ as y,f as x,m,u as k,D as c,q as v,o as s,g as _,w as u,d as a,c as i,h as o,N as E,P as I,Q as C,F as L,a as h,t as g,b as S,v as A,x as q}from"./entry.4421f2c3.js";const $=x({name:"ModalLoginEmail",data(){return{email:null,code:null,codeRequestId:null,loading:!1,error:null,mode:"login",codeLength:6,maxAttemptsExceeded:!1}},computed:{...m(k,["showLoginEmailModal"]),...m(c,["isUserLogged","isLoginPending"]),isLoading(){return this.loading},canSubmit(){var e;switch(this.mode){case"login":return this.email&&/^[_a-z0-9-]+(\.[_a-z0-9-]+)*(\+[a-z0-9-]+)?@[a-z0-9-]+(\.[a-z0-9-]+)*$/i.test(this.email);case"verify":return((e=this.code)==null?void 0:e.length)===this.codeLength&&!this.maxAttemptsExceeded}}},methods:{...v(c,["loginEmail","sendChallengeAnswer"]),close(){this.showLoginEmailModal=!1,this.isLoginPending=!1,this.maxAttemptsExceeded=!1},resetInput(){var e;this.code="",(e=this.$refs.CodeInput)==null||e.init()},async codeUpdate(e){this.code=e,this.canSubmit&&await this.onSubmit()},async onSubmit(){var t,d,l;this.error=null;let e=null;try{switch(this.loading=!0,this.mode){case"login":e=await this.loginEmail((t=this.email)==null?void 0:t.toLowerCase()),this.codeRequestId=(d=e==null?void 0:e.challengeParam)==null?void 0:d.requestId,this.mode="verify";break;case"verify":e=await this.sendChallengeAnswer(this.code.toString()),e.signInUserSession||(this.error="Invalid code, a new code has been sent, please try again."),this.codeRequestId=(l=e==null?void 0:e.challengeParam)==null?void 0:l.requestId,this.resetInput();break}}catch(r){if(r.name==="NotAuthorizedException"){this.error="Invalid verification code or email address.",this.maxAttemptsExceeded=!0,this.resetInput();return}this.mode==="verify"&&this.resetInput(),this.error=r.message}finally{this.loading=!1}}},mounted(){this.$gtmCustomEvent({event:"modal_show",action:"modalOpen",modalName:"LoginEmail"})},watch:{isUserLogged(e){e&&this.close()},mode(e){this.error=null}}}),N={class:"px-4 md:px-7 pt-4 w-full"},z={class:"animate-fade-in"},B={class:"text-center block"},M={key:0,class:"text-2xl tracking-wide font-semibold mb-2 text-center animate-slide-down-fade-in01s"},R={key:1,class:"text-2xl tracking-wide font-semibold mb-2 text-center animate-slide-down-fade-in01s"},U={key:2,class:"text-slate-100 lg:text-xl mt-2 mb-6 leading-tight animate-slide-down-fade-in04s"},V={key:3,class:"text-slate-100 lg:text-xl mt-2 mb-6 leading-tight animate-slide-down-fade-in04s"},P=["disabled"],D=a("h3",{class:"text-xl tracking-wide font-semibold mb-2 text-center animate-slide-down-fade-in01s"},"Enter Code",-1),F={key:0,class:"pb-3 text-2xs text-slate-50 animate-slide-down-fade-in01s"},K={key:5,class:"text-red mb-4"};function T(e,t,d,l,r,G){const p=w,f=A,b=q;return s(),_(b,{onClose:e.close,transitionName:"none"},{default:u(()=>[a("div",N,[a("article",z,[a("div",B,[e.mode==="login"?(s(),i("h1",M,"Sign In")):o("",!0),e.mode==="verify"?(s(),i("h1",R,"Verify")):o("",!0),e.mode==="login"?(s(),i("p",U,"Sign in with your verified email")):o("",!0),e.mode==="verify"?(s(),i("p",V,"Check your email for your verification code")):o("",!0),E(a("input",{class:"block relative w-full mb-4 bg-black/50 rounded-lg py-3 px-1 sm:px-3 border-2 outline-none focus:ring-0 autofill:bg-slate-800 appearance-none hover:appearance-none disabled:text-slate-100 text-sm text-center transition-all duration-200",name:"Email",type:"text",placeholder:"Enter Email Address",autocomplete:"off","onUpdate:modelValue":t[0]||(t[0]=n=>e.email=n),disabled:e.isLoading||e.mode!=="login",onKeyup:t[1]||(t[1]=I((...n)=>e.onSubmit&&e.onSubmit(...n),["enter"]))},null,40,P),[[C,e.email]]),e.mode==="verify"?(s(),i(L,{key:4},[D,h(p,{class:"animate-slide-down-fade-in01s mb-2",ref:"CodeInput",length:e.codeLength,disabled:e.isLoading,onUpdate:e.codeUpdate},null,8,["length","disabled","onUpdate"]),e.codeRequestId?(s(),i("p",F," Request ID: "+g(e.codeRequestId),1)):o("",!0)],64)):o("",!0),e.error?(s(),i("p",K,g(e.error),1)):o("",!0),h(f,{isLoading:e.isLoading,size:"md",disabled:!e.canSubmit,class:"w-full",onClick:e.onSubmit},{default:u(()=>[S(" Continue ")]),_:1},8,["isLoading","disabled","onClick"]),e.mode==="verify"&&!e.maxAttemptsExceeded?(s(),i("p",{key:6,class:"animate-slide-down-fade-in01s text-slate-100 text-sm mt-5 cursor-pointer",onClick:t[2]||(t[2]=n=>{e.mode="login",e.maxAttemptsExceeded=!1})}," Go Back ")):o("",!0)])])])]),_:1},8,["onClose"])}const W=y($,[["render",T]]);export{W as default};
//# sourceMappingURL=Email.5f0df9f5.js.map
